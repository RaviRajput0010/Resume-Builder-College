<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/x-icon" href="logo/y.png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resume Builder</title>
    <style>

* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

html, body {
    height: 100%;
    font-family: Arial, sans-serif;
    background-color: #f5f5f5;
}


.container {
    display: flex;
    flex-direction: column;
    min-height: 100vh; 
    background: linear-gradient(to right, #f5f5f5, #e0eafc);
}


.main {
    display: flex;
    flex: 1; 
    gap: 20px;
    padding: 20px;
}


.left {
    background-color:midnightblue   ;
    padding: 10px;
    width: 10%;
    min-width: 200px;
    box-shadow: 2px 0 10px #ccc;
    display: flex;
    flex-direction:column;
    align-items: self-start;
}

.left img
{
    height: 50px;
    width: 50px;
}

.left h2 {
    font-size: 17px;
    color: whitesmoke
}


.right {
    background-color: #ffffff;
    padding: 40px;
    width: 90%;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
    border-radius: 8px;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
}


.form-container {
    display: flex;
    justify-content: space-between;
    gap: 30px;
    align-items: flex-start;
}


.form-fields {
    width: 70%;
}

input, button {
    width: 44%;
    height: 50px;
    padding: 10px;
    margin: 10px 0;
    border: 1px solid #ccc;
    background-color: rgb(216, 230, 226);
    transition: all 0.3s ease;
    
}


input:focus {
    border-color: #2e9ad0;
    box-shadow: 0 0 8px rgba(76, 175, 80, 0.5);
}


.photo {
    margin-top: 20px;
    width: 45%;
    max-width: 330px;
    height: 230px;
    border: 2px dashed #ccc;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    background-color: #f0f0f0;
    transition: background 0.3s ease;
}


.photo:hover {
    background-color: #e8e8e8;
}

.photo img {
    max-width: 100%;
    max-height: 100%;
    object-fit: cover;
    border-radius: 8px;
}


button {
    background: #4CAF50;
    color: white;
    cursor: pointer;
    width: 345px;
    height: 45px;
    border: none;
    border-radius: 5px;
    transition: all 0.3s ease;
    font-size: 20px;
}


button:hover
 {
    background-color:rgb(45, 196, 45);
    transform: scale(1.01);
}


.hidden {
    display: none;
}


@media screen and (max-width: 1024px) {
    .main {
        flex-direction: column;
    }
    
    .left, .right {
        width: 100%;
    }

    .form-container {
        flex-direction: column;
    }

    .photo {
        width: 100%;
        max-width: 100%;
    }
}

.element 
{
    display: flex;
    justify-content: center;
    align-items: center;
}

textarea
{
    padding: 10px;
    margin: 10px 0;
    border: 1px solid #ccc;
    background-color: rgb(216, 230, 226);
    transition: all 0.3s ease;
    outline-color: white;

}

#pincode
{
    position: relative;
    bottom: 32px;
}

.image
{
    background-color: #45a049;
    height: 100%;
    width: 100%;
}

.image img
{
    height: 100%;
    width: 100%;
}

    </style>
</head>
<body>

<div class="container">
    <div class="main">
        <div class="left">
            <div class="element">
                <img src="bird.png" alt="">
                <h2>Resume Builder</h2>
            </div>  
           
                     
        </div>

        <div class="right">
            <form id="resumeForm">
                <div class="form-container">
                    
                    <!-- Form Fields -->
                    <div id="personalFields">
                        <h3>Personal Information</h3>
                        <input type="text" id="name" placeholder="Enter Name" required>
                        <input type="text" id="lastname" placeholder="Enter Last Name" required>
                        <input type="number" id="phone" placeholder="Enter Phone" required>
                        <input type="email" id="email" placeholder="Enter Email" required>
                        <input type="text" id="city" placeholder="Enter City" required>
                        <input type="text" id="country" placeholder="Enter Country" required>
                        <input type="number" id="pincode" placeholder="Enter Pin Code" required>
                        <textarea id="objective" cols="42" rows="2" placeholder="Introduce Yourself"></textarea>
                    </div>

                     <!-- Education Fields -->
                <div id="educationFields" class="hidden">
                    <h3>Education Details</h3>
                    <input type="text" id="tenth_percentage" placeholder="10th Percentage" required>
                    <input type="text" id="twelfth_percentage" placeholder="12th Percentage">
                    <input type="text" id="graduation_percentage" placeholder="Graduation Percentage">
                    <input type="text" id="post_graduation_percentage" placeholder="Post-Graduation Percentage">
                </div>

                <!-- Achievements -->
                <div id="achievementFields" class="hidden">
                    <h3>Achievements</h3>
                    <input type="text" id="hobbies" placeholder="Hobbies">
                    <input type="text" id="certificates" placeholder="Certificates">
                </div>

                <!-- Work Experience -->
                <div id="workexperience" class="hidden">
                    <h3>Work Experience</h3>
                    <input type="text" id="internship_company" placeholder="Internship Company">
                    <input type="text" id="internship_description" placeholder="Internship Description">
                    <input type="number" id="internship_duration" placeholder="Internship Duration (months)">
                    <input type="text" id="company_name" placeholder="Company Name">
                    <input type="text" id="job_title" placeholder="Job Title">
                    <input type="date" id="date_of_joining" placeholder="Date of Joining">
                    <input type="text" id="job_description" placeholder="Job Description">
                </div>

                <!-- Skills -->
                <div id="skills" class="hidden">
                    <h3>Skills</h3>
                    <input type="text" id="technical_skills" placeholder="Technical Skills">
                    <input type="text" id="soft_skills" placeholder="Soft Skills">
                </div>

                    <!-- Photo Section -->
                    <div class="photo" onclick="document.getElementById('fileInput').click()">
                        <img id="preview" src="logo/pic.png" alt="Upload Photo">
                        <input type="file" id="fileInput" accept="image/*" style="display: none;">
                
                    </div>
                </div>

                <!-- Navigation Buttons -->
                <!-- Navigation Buttons -->
                <button type="button" id="nextButton" onclick="nextStep()">Next</button>
                <button type="button" id="finishButton" class="hidden" onclick="storeFormData()">Finish</button>

            </form>
        </div>
    </div>
</div>

<script>
    
var templateid = JSON.parse(localStorage.getItem('resumeid'));

    // Image Preview
    document.getElementById('fileInput').addEventListener('change', function(event) {
        const file = event.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById('preview').src = e.target.result;
            };
            reader.readAsDataURL(file);
        }
    });
    let step = 0;  // Start at the first step
    function nextStep() {
    const steps = ['personalFields', 'educationFields', 'achievementFields', 'workexperience', 'skills'];

    if (!validateFields(steps[step])) return; // Validate current step before moving

    if (step < steps.length) {
        document.getElementById(steps[step]).classList.add('hidden');
        step++;
    }

    if (step < steps.length) {
        document.getElementById(steps[step]).classList.remove('hidden');
    }

    if (step >= steps.length - 1) {
        document.getElementById('nextButton').classList.add('hidden');
        document.getElementById('finishButton').classList.remove('hidden');
    }
}


     var logindet = JSON.parse(localStorage.getItem('userlogindata'))

     console.log(logindet)



    async function storeFormData()
     {
        const formData = {
            useruniquedetail: logindet[0].email,
            templateid: templateid,

            personalDetails:{
            name: document.getElementById("name").value,
            lastname: document.getElementById("lastname").value,
            phone: document.getElementById("phone").value,
            email: document.getElementById("email").value,
            city: document.getElementById("city").value,
            country: document.getElementById("country").value,
            pincode: document.getElementById("pincode").value,
            photo: document.getElementById("preview").src,
            objective:document.getElementById('objective').value,
            },
            education: 
            {
                tenth_percentage: document.getElementById("tenth_percentage").value,
                twelfth_percentage: document.getElementById("twelfth_percentage").value,
                graduation_percentage: document.getElementById("graduation_percentage").value,
                post_graduation_percentage: document.getElementById("post_graduation_percentage").value
            },

            // Achievements
            achievements: 
            {
                hobbies: document.getElementById("hobbies").value,
                certificates: document.getElementById("certificates").value
            },

            // Work Experience
            workExperience: 
            {
                internship_company: document.getElementById("internship_company").value,
                internship_description: document.getElementById("internship_description").value,
                internship_duration: document.getElementById("internship_duration").value,
                company_name: document.getElementById("company_name").value,
                job_title: document.getElementById("job_title").value,
                date_of_joining: document.getElementById("date_of_joining").value,
                job_description: document.getElementById("job_description").value
            },

            // Skills
            skills: 
            {
                technical_skills: document.getElementById("technical_skills").value,
                soft_skills: document.getElementById("soft_skills").value
            }
        };


        try {
    const res = await fetch("https://online-resume-builder-application.onrender.com/dataform", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(formData),
    });

    const result = await res.json();
    alert(result.message || "Submission successful!");
    window.location.href="index2.html";    
  } catch (err) {
    console.error(err);
  }
     }
     function validateFields(sectionId) {
    const fields = document.querySelectorAll(`#${sectionId} input, #${sectionId} textarea`);
    for (let field of fields) {
        const value = field.value.trim();

        if (field.hasAttribute("required") && value === "") {
            alert(`Please fill the required field: ${field.placeholder || field.id}`);
            field.focus();
            return false;
        }

        // Letters only for name and lastname
        if (field.id === "name" || field.id === "lastname") {
            if (!/^[a-zA-Z\s]+$/.test(value)) {
                alert(`${field.placeholder || field.id} should contain only letters.`);
                field.focus();
                return false;
            }
        }

        // Email format
        if (field.type === "email" && !/^\S+@\S+\.\S+$/.test(value)) {
            alert("Please enter a valid email address.");
            field.focus();
            return false;
        }

        // Phone number should start with 7, 8, or 9 and be 10 digits
        if (field.id === "phone") {
            if (!/^[789]\d{9}$/.test(value)) {
                alert("Phone number must start with 7, 8, or 9 and be exactly 10 digits.");
                field.focus();
                return false;
            }
        }

        // Pincode should be exactly 6 digits
        if (field.id === "pincode") {
            if (!/^\d{6}$/.test(value)) {
                alert("Pincode must be exactly 6 digits.");
                field.focus();
                return false;
            }
        }

        // Number field check (fallback)
        if (field.type === "number" && isNaN(value)) {
            alert(`Please enter a valid number in: ${field.placeholder || field.id}`);
            field.focus();
            return false;
        }
    }
    return true;
}



</script>

</body>
</html>
